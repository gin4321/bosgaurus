<script>
$(function() {

	$('.clear-cart').on('click',function(e){
		e.preventDefault();
		clearCart(true);
	})

	$('.discount').on('click', async function(e) {
		e.preventDefault()
		
		let queryStr = ''
		let cart = await getCart()
		let itemsInCart = cart.items
		
		let promises = itemsInCart.map(async item => {
			
			let productDiscount = await getProductDiscount(item.url + '.js')
			
			for(variantIndex in productDiscount.variants){
				let variant = productDiscount.variants[variantIndex]
				let quantity = 0

				if(variant.title === 'Discount') {
					quantity = item.quantity
					
				}

				queryStr += 'updates['+ variant.id +']='+ quantity + '&'
			}
		})

		Promise.all(promises).then(async () => {
			 console.log(queryStr)
			 await discount(queryStr)
		})
	})
		
});

getCart = () => $.getJSON('/cart.js')

getProductDiscount = url => $.getJSON(url)

discount = queryStr => $.post('/cart/update.js', queryStr)

clearCart = is_redirect => {
	return $.ajax({
		type: "POST",
		url: '/cart/clear.js',
		success: function(){
			if(is_redirect) location.href = '/cart'
		},
		dataType: 'json'
	});
}

onChangeQuantity = (event, value) => {
	let el = $(event.target)
	let no_trigger = el.attr('no_trigger') 

	let quantityDropdown = el.closest('.quantity-dropdown')

	let quantityNumberField = quantityDropdown.siblings('.quantity-number-field')
	let updateCart = quantityDropdown.siblings('.update-cart')
	
	let item = updateCart.attr('item')

	let url = '/cart/change?line='+ item +'&quantity=' + value
	
	if(value === "10+") {
		$(quantityDropdown).hide()
		$(quantityNumberField).show().attr('disabled', false)
		$(updateCart).show()
	} else if(!no_trigger) {
		//trigger
		location.href = url
	}
};

updateCart = (event) => {
	let el = $(event.target)
	
	let quantityNumberField = el.siblings('.quantity-number-field').val()
	let item = el.attr('item')

	let url = '/cart/change?line='+ item +'&price=' + 100000

	location.href = url
	
};

$(document).on('submit','.product-form',function(e){
	e.preventDefault()

  let inputArray = $(this).serializeArray()
	let inputObject = {}
	
	$(inputArray).each(function(i, field){
		inputObject[field.name] = field.value;
	});
	
	let id = inputObject['product-id']
	let quantity = inputObject['quantity-select'] === '10+' ? inputObject['quantity-number'] : inputObject['quantity-select']
	
	let formData = new FormData()
	formData.append('id', id)
	formData.append('quantity', quantity)

	$.ajax({
		url: '/cart/add.js',
		data: formData,
		processData: false,
		contentType: false,
		type: 'POST',
		success: function(data){
			location.href = '/cart'
		}
	});
	
})
var positionFakeLogo = 0
$(document).ready(function() {
	var bosgaurus = '<svg id="layer1" class="Layer1" data-name="Layer1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 601.17999 151.89467" id="svg2" version="1.1"><metadata id="metadata8"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs id="defs6"><clipPath id="clipPath18" clipPathUnits="userSpaceOnUse"><path id="path16" d="M 0,113.921 H 450.885 V 0 H 0 Z" /></clipPath></defs><g transform="matrix(1.3333333,0,0,-1.3333333,0,151.89467)" id="g10"><g id="g12"><g clip-path="url(#clipPath18)" id="g14"><g transform="translate(21.6092,48.6)" id="g20"><path id="path22" d="m 0,0 h 6.829 c 3.864,0 5.322,2.357 5.322,4.789 0,2.503 -1.458,3.646 -2.82,4.009 v 0.025 c 1.388,0.533 2.312,2.015 2.312,3.717 0,2.819 -2.092,4.182 -5.107,4.182 H 0 Z m 1.994,9.575 v 5.396 H 6.61 c 1.825,0 3.014,-0.801 3.014,-2.552 0,-1.895 -1.045,-2.844 -3.158,-2.844 z m 0,-7.825 v 6.074 h 4.641 c 2.527,0 3.501,-1.239 3.501,-3.011 0,-1.654 -0.9,-3.063 -3.331,-3.063 z M 24.38,-0.293 c 4.885,0 8.141,3.646 8.141,8.654 0,5.008 -3.256,8.653 -8.141,8.653 -4.885,0 -8.143,-3.645 -8.143,-8.653 0,-5.008 3.258,-8.654 8.143,-8.654 m 0,1.751 c -3.72,0 -6.053,3.063 -6.053,6.903 0,3.84 2.333,6.903 6.053,6.903 3.72,0 6.053,-3.063 6.053,-6.903 0,-3.84 -2.333,-6.903 -6.053,-6.903 m 18.691,-1.751 c 3.43,0 6.589,1.849 6.589,5.177 0,2.94 -2.358,3.816 -5.057,4.426 l -2.405,0.533 c -2.163,0.487 -3.355,1.045 -3.355,2.576 0,1.627 1.482,2.965 3.914,2.965 2.357,0 3.938,-1.288 4.227,-3.522 l 2.115,0.339 c -0.413,2.964 -2.672,4.813 -6.269,4.813 -3.476,0 -6.077,-1.969 -6.077,-4.669 0,-2.696 2.213,-3.741 4.935,-4.348 l 2.406,-0.536 c 2.453,-0.533 3.476,-1.119 3.476,-2.866 0,-1.994 -1.944,-3.258 -4.425,-3.258 -2.697,0 -4.617,1.434 -4.934,4.398 L 36.097,5.396 c 0.413,-3.865 3.331,-5.689 6.974,-5.689 m 18.207,0 c 3.063,0 4.934,1.412 5.785,2.894 h 0.024 V 0 h 1.994 V 8.918 H 61.158 V 7.146 h 5.953 C 67.087,5.541 66.699,4.327 65.873,3.307 64.998,2.212 63.586,1.458 61.497,1.458 c -3.452,0 -6.028,2.625 -6.028,6.903 0,4.132 2.53,6.903 6.052,6.903 2.965,0 4.62,-1.8 5.251,-3.72 l 2.066,0.657 c -0.802,2.188 -3.015,4.813 -7.317,4.813 -4.933,0 -8.142,-3.621 -8.142,-8.629 0,-5.078 3.258,-8.678 7.899,-8.678 M 86.971,0 h 2.114 l -6.61,16.722 H 79.898 L 73.288,0 h 2.113 l 1.8,4.666 h 7.973 z m -5.784,15.045 3.331,-8.629 h -6.66 z M 99.055,-0.293 c 3.885,0 6.243,2.262 6.243,6.49 v 10.525 h -1.99 V 6.367 c 0,-2.99 -1.12,-4.909 -4.253,-4.909 -2.895,0 -4.256,1.919 -4.256,4.909 V 16.722 H 92.808 V 6.197 c 0,-4.228 2.357,-6.49 6.247,-6.49 M 121.317,0 h 2.382 l -4.98,7.535 c 2.38,0.462 3.935,2.015 3.935,4.496 0,3.233 -2.163,4.691 -5.202,4.691 h -6.366 V 0 h 1.993 v 7.39 h 3.452 z m -8.238,14.946 h 4.352 c 2.114,0 3.159,-1.044 3.159,-2.915 0,-1.87 -1.239,-2.869 -3.402,-2.869 h -4.109 z m 20.83,-15.239 c 3.89,0 6.247,2.262 6.247,6.49 v 10.525 h -1.991 V 6.367 c 0,-2.99 -1.118,-4.909 -4.256,-4.909 -2.89,0 -4.253,1.919 -4.253,4.909 v 10.355 h -1.99 V 6.197 c 0,-4.228 2.357,-6.49 6.243,-6.49 m 17.77,0 c 3.426,0 6.586,1.849 6.586,5.177 0,2.94 -2.358,3.816 -5.054,4.426 l -2.407,0.533 c -2.163,0.487 -3.354,1.045 -3.354,2.576 0,1.627 1.483,2.965 3.914,2.965 2.358,0 3.936,-1.288 4.229,-3.522 l 2.114,0.339 c -0.413,2.964 -2.672,4.813 -6.271,4.813 -3.474,0 -6.075,-1.969 -6.075,-4.669 0,-2.696 2.21,-3.741 4.934,-4.348 l 2.404,-0.536 c 2.456,-0.533 3.476,-1.119 3.476,-2.866 0,-1.994 -1.945,-3.258 -4.422,-3.258 -2.7,0 -4.62,1.434 -4.934,4.398 l -2.114,-0.339 c 0.413,-3.865 3.328,-5.689 6.974,-5.689 m 25.72,0 c 4.059,0 6.537,2.382 7.387,5.396 l -2.04,0.561 c -0.656,-2.53 -2.333,-4.206 -5.322,-4.206 -3.695,0 -5.982,2.745 -5.982,6.903 0,4.108 2.287,6.903 5.982,6.903 2.89,0 4.616,-1.871 5.199,-4.108 l 2.067,0.558 c -0.754,2.675 -3.186,5.3 -7.266,5.3 -4.958,0 -8.071,-3.695 -8.071,-8.653 0,-5.054 3.113,-8.654 8.046,-8.654 m 19.252,0 c 4.885,0 8.142,3.646 8.142,8.654 0,5.008 -3.257,8.653 -8.142,8.653 -4.887,0 -8.142,-3.645 -8.142,-8.653 0,-5.008 3.255,-8.654 8.142,-8.654 m 0,1.751 c -3.719,0 -6.052,3.063 -6.052,6.903 0,3.84 2.333,6.903 6.052,6.903 3.717,0 6.05,-3.063 6.05,-6.903 0,-3.84 -2.333,-6.903 -6.05,-6.903 m 23.381,13.488 v 1.776 H 209.607 V 0 h 1.991 v 7.803 h 8.071 v 1.772 h -8.071 v 5.371 z m 14.999,0 v 1.776 H 224.606 V 0 h 1.991 v 7.803 h 8.071 v 1.772 h -8.071 v 5.371 z m 6.565,-13.171 v 6.099 h 7.972 v 1.775 h -7.972 v 5.297 h 8.481 v 1.776 H 239.602 V 0 h 10.793 v 1.775 z m 15.363,0 v 6.099 h 7.972 v 1.775 h -7.972 v 5.297 h 8.48 v 1.776 H 254.965 V 0 h 10.792 V 1.775 Z M 287.928,0 h 2.382 l -4.984,7.535 c 2.383,0.462 3.939,2.015 3.939,4.496 0,3.233 -2.163,4.691 -5.203,4.691 h -6.366 V 0 h 1.991 v 7.39 h 3.452 z m -8.241,14.946 h 4.351 c 2.114,0 3.159,-1.044 3.159,-2.915 0,-1.87 -1.239,-2.869 -3.402,-2.869 h -4.108 z m 22.241,-15.239 c 4.887,0 8.142,3.646 8.142,8.654 0,5.008 -3.255,8.653 -8.142,8.653 -4.885,0 -8.142,-3.645 -8.142,-8.653 0,-5.008 3.257,-8.654 8.142,-8.654 m 0,1.751 c -3.717,0 -6.05,3.063 -6.05,6.903 0,3.84 2.333,6.903 6.05,6.903 3.719,0 6.052,-3.063 6.052,-6.903 0,-3.84 -2.333,-6.903 -6.052,-6.903 M 326.019,0 h 2.113 l -6.611,16.722 h -2.576 L 312.335,0 h 2.114 l 1.797,4.666 h 7.973 z m -5.786,15.045 3.329,-8.629 h -6.66 z M 337.71,-0.293 c 3.428,0 6.586,1.849 6.586,5.177 0,2.94 -2.358,3.816 -5.054,4.426 l -2.407,0.533 c -2.163,0.487 -3.353,1.045 -3.353,2.576 0,1.627 1.483,2.965 3.911,2.965 2.358,0 3.938,-1.288 4.231,-3.522 l 2.114,0.339 c -0.413,2.964 -2.675,4.813 -6.271,4.813 -3.477,0 -6.077,-1.969 -6.077,-4.669 0,-2.696 2.213,-3.741 4.933,-4.348 l 2.407,-0.536 c 2.457,-0.533 3.477,-1.119 3.477,-2.866 0,-1.994 -1.945,-3.258 -4.423,-3.258 -2.699,0 -4.619,1.434 -4.933,4.398 l -2.118,-0.339 c 0.416,-3.865 3.331,-5.689 6.977,-5.689 M 352.49,0 h 1.991 v 14.946 h 5.203 v 1.776 h -12.396 v -1.776 h 5.202 z m 13.271,1.775 v 6.099 h 7.972 v 1.775 h -7.972 v 5.297 h 8.484 v 1.776 H 363.77 V 0 h 10.79 V 1.775 Z M 389.364,0 h 2.382 l -4.983,7.535 c 2.383,0.462 3.938,2.015 3.938,4.496 0,3.233 -2.163,4.691 -5.202,4.691 h -6.366 V 0 h 1.993 v 7.39 h 3.449 z m -8.238,14.946 h 4.349 c 2.114,0 3.159,-1.044 3.159,-2.915 0,-1.87 -1.239,-2.869 -3.403,-2.869 h -4.105 z m 19.955,-15.239 c 3.427,0 6.586,1.849 6.586,5.177 0,2.94 -2.357,3.816 -5.055,4.426 l -2.406,0.533 c -2.164,0.487 -3.353,1.045 -3.353,2.576 0,1.627 1.482,2.965 3.914,2.965 2.357,0 3.935,-1.288 4.228,-3.522 l 2.114,0.339 c -0.413,2.964 -2.672,4.813 -6.271,4.813 -3.474,0 -6.074,-1.969 -6.074,-4.669 0,-2.696 2.209,-3.741 4.933,-4.348 l 2.404,-0.536 c 2.457,-0.533 3.476,-1.119 3.476,-2.866 0,-1.994 -1.944,-3.258 -4.422,-3.258 -2.7,0 -4.62,1.434 -4.934,4.398 l -2.115,-0.339 c 0.414,-3.865 3.33,-5.689 6.975,-5.689" /></g></g></g></g></svg>'
	var bos = '<svg id="layer2" class="Layer2" data-name="Layer2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 403.18 71.28"><path d="M853.6,441.6h15.8V422.5H853.6Zm-69.5,2c23.4,0,45-12.6,45-35.3,0-20.1-16.1-26.1-34.5-30.3l-16.5-3.6c-14.7-3.4-22.9-7.2-22.9-17.6s10.1-20.3,26.8-20.3,26.9,8.8,28.9,24.1l14.4-2.3c-2.8-20.3-18.3-32.9-42.8-32.9s-41.6,13.4-41.6,31.9S756,382.8,774.6,387l16.5,3.6c16.8,3.7,23.7,7.7,23.7,19.6,0,13.7-13.2,22.3-30.2,22.3s-31.5-9.8-33.7-30.1l-14.5,2.4c2.9,26.4,22.8,38.8,47.7,38.8M658.2,431.7c-25.4,0-41.3-21-41.3-47.2s15.9-47.2,41.3-47.2,41.4,21,41.4,47.2-16,47.2-41.4,47.2m0,11.9c33.4,0,55.7-24.9,55.7-59.1s-22.3-59.1-55.7-59.1-55.6,24.9-55.6,59.1,22.2,59.1,55.6,59.1M510.3,429.7V388.2H542c17.2,0,23.9,8.4,23.9,20.6s-6.2,20.9-22.8,20.9Zm0-53.5V339.3h31.5c12.5,0,20.6,5.5,20.6,17.5s-7.1,19.4-21.6,19.4Zm-13.7,65.4h46.7c26.4,0,36.4-16.1,36.4-32.7s-10-24.9-19.3-27.4v-.2c9.5-3.6,15.8-13.7,15.8-25.4,0-19.2-14.3-28.5-34.9-28.5H496.6Z" transform="translate(-496.6 -325.4)"/></svg>'
	
	$('#logoID').mouseenter(function() {
		if($('#fakeLogo').position().left !== positionFakeLogo)
		$('#fakeLogo').animate( {"left": "-=580px"}, 1000, "linear" , function() {
			positionFakeLogo = $('#fakeLogo').position().left
		})
		
	})
})


function myFunction(id) {
  var x = document.getElementById(id);
  if (x.className.indexOf("w3-show") == -1) {
    x.className += " w3-show";
  } else { 
    x.className = x.className.replace(" w3-show", "");
  }
} 

onChangeQuatityProd = value => {
	if(value === "10") {
		$('.quantity-dropdown').hide()
		$('.quantity-number-field').show()
		$('.quantity-number-field').attr('disabled', false)
		$('.update-cart').show()
	} 
};

getNumberOfProd = () => {
	let quantity = $('.quantity-select').val()
	let url = '/cart/change?line='+ item +'&quantity=' + quantity
	if(quantity==='10') {
		
	}
}

function openTab(evt, tabName) {
console.log('abc')
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(tabName).style.display = "block";
  evt.currentTarget.className += " active";
}

document.getElementById("defaultOpen").click();

grindChange = value => {
	if(value === "grind") {
		$('.grindChoice').show()
	} else $('.grindChoice').hide()
}

var modal = document.getElementById("myModal");

// Get the button that opens the modal
var btn = document.getElementById("myBtn");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks the button, open the modal 
btn.onclick = function() {
  modal.style.display = "block";
}

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
  modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}
</script>